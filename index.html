<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AI Interview Bot</title>
<style>
  body,html{margin:0;padding:0;height:100%;font-family:Inter,system-ui,sans-serif;background:linear-gradient(135deg,#050d1f,#0b122f);color:#f0f7ff;overflow:hidden}
  #app{height:100%;display:flex;flex-direction:column}
  .screen{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;text-align:center}
  h1,h2{margin:0 0 14px}
  input,button,select,textarea{
    font-size:16px;padding:10px 14px;border-radius:10px;
    border:1px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.05);color:#fff;outline:none;margin:8px 0;
  }
  button{cursor:pointer;font-weight:700;background:linear-gradient(90deg,#5ee3ff,#6b61ff);color:#021}
  .btn-ghost{background:transparent;color:#5ee3ff;border:1px solid rgba(255,255,255,0.15)}
  .hidden{display:none}
  .bubble{max-width:700px;padding:18px;border-radius:14px;background:rgba(255,255,255,0.05);margin:10px auto}
  .options{display:flex;gap:14px;flex-wrap:wrap;justify-content:center}
  textarea{width:100%;min-height:80px}
  .score{font-size:22px;font-weight:900;color:#7ee787}
  .improve{margin-top:14px;color:#ffd280}
  .muted{color:rgba(255,255,255,0.6);margin-bottom:8px}
</style>
</head>
<body>
<div id="app">

  <!-- Screen 1: ask name -->
  <div id="nameScreen" class="screen">
    <h1>ü§ñ AI Interview Bot</h1>
    <p class="bubble">Hello candidate, what is your <strong>name</strong>?</p>
    <input id="nameInput" placeholder="Enter your name"/>
    <button id="nameBtn">Continue</button>
  </div>

  <!-- Screen 2: choose company -->
  <div id="companyScreen" class="screen hidden">
    <h2>Welcome, <span id="showName"></span> üëã</h2>
    <p class="bubble">Please choose a <strong>company</strong> for the interview:</p>
    <div class="options">
      <button class="btn-ghost companyBtn" data-co="Tata">Tata Motors</button>
      <button class="btn-ghost companyBtn" data-co="Bosch">Bosch</button>
      <button class="btn-ghost companyBtn" data-co="Kirloskar">Kirloskar</button>
    </div>
  </div>

  <!-- Screen 3: interview -->
  <div id="interviewScreen" class="screen hidden">
    <h2 id="companyTitle"></h2>
    <div id="progress" class="muted"></div>
    <div class="bubble" id="questionText">Question here</div>
    <button id="askBtn" class="btn-ghost">üîä Repeat</button>

    <div style="margin-top:10px">
      <button id="recordBtn">üéôÔ∏è Record</button>
      <button id="stopBtn" class="btn-ghost">‚èπ Stop</button>
    </div>

    <textarea id="transcript" placeholder="Your answer (spoken or type)..."></textarea>
    <button id="evalBtn">‚úÖ Submit Answer</button>
    <div id="feedback" class="bubble hidden"></div>
  </div>

  <!-- Screen 4: results -->
  <div id="resultScreen" class="screen hidden">
    <h2>Interview Complete ‚úÖ</h2>
    <div class="score" id="finalScore"></div>
    <div class="improve" id="improveText"></div>
    <button id="restartBtn">Restart</button>
  </div>

</div>

<script>
/* --- Question bank --- */
const BANK = {
  Tata:[ "Tell me about yourself and why you want to join Tata Motors?",
    "Explain the working principle of a 4-stroke SI engine.",
    "What is the function of a differential in automobiles?",
    "How do you select material for a car chassis?",
    "Where do you see yourself in 5 years at Tata Motors?",
    "What is fatigue failure and how to prevent it?",
    "Explain regenerative braking in hybrid vehicles.",
    "What is suspension damping and why is it needed?",
    "How do you perform a simple FEA validation on a bracket?",
    "Explain the role of NVH in vehicle design." ],
  Bosch:[ "Introduce yourself and one strength for Bosch.",
    "What is mechatronics and its applications?",
    "Explain PLC and its importance.",
    "Hydraulic vs pneumatic ‚Äî differences?",
    "Describe PID control basics.",
    "What is Industry 4.0?",
    "Types of sensors for position sensing?",
    "Difference between stepper and servo?",
    "How to size a motor for a load?",
    "Importance of safety standards in automation?" ],
  Kirloskar:[ "Short intro ‚Äî why Kirloskar?",
    "Explain working principle of a centrifugal pump.",
    "What is cavitation and prevention methods?",
    "IC engine vs gas turbine differences?",
    "How to select a pump for an application?",
    "Explain pump affinity laws.",
    "What is specific speed of a pump?",
    "Diagnose vibration or overheating in a pump.",
    "Materials for impellers and why?",
    "How to improve pump efficiency?" ]
};

/* --- Elements --- */
const nameScreen=document.getElementById("nameScreen");
const companyScreen=document.getElementById("companyScreen");
const interviewScreen=document.getElementById("interviewScreen");
const resultScreen=document.getElementById("resultScreen");
const nameInput=document.getElementById("nameInput");
const showName=document.getElementById("showName");
const nameBtn=document.getElementById("nameBtn");
const companyBtns=document.querySelectorAll(".companyBtn");
const companyTitle=document.getElementById("companyTitle");
const progress=document.getElementById("progress");
const questionText=document.getElementById("questionText");
const askBtn=document.getElementById("askBtn");
const recordBtn=document.getElementById("recordBtn");
const stopBtn=document.getElementById("stopBtn");
const transcript=document.getElementById("transcript");
const evalBtn=document.getElementById("evalBtn");
const feedback=document.getElementById("feedback");
const finalScore=document.getElementById("finalScore");
const improveText=document.getElementById("improveText");
const restartBtn=document.getElementById("restartBtn");

let candidate="", company="", questions=[], idx=0, score=0;

/* --- TTS helper --- */
function speak(txt){
  if(!("speechSynthesis" in window)) return;
  speechSynthesis.cancel();
  const u=new SpeechSynthesisUtterance(txt);
  u.lang="en-IN"; u.rate=0.95; u.pitch=0.95;
  speechSynthesis.speak(u);
}

/* --- STT helper --- */
let recognition=null, recognizing=false;
function initRecognition(){
  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!SR) return null;
  const r=new SR();
  r.lang="en-IN"; r.interimResults=false; r.maxAlternatives=1;
  r.onstart=()=>{recognizing=true; console.log("Listening...")};
  r.onend=()=>{recognizing=false; console.log("Stopped")};
  r.onresult=e=>{transcript.value=e.results[0][0].transcript;};
  return r;
}
if("SpeechRecognition" in window||"webkitSpeechRecognition" in window){
  recognition=initRecognition();
}

/* --- Flow --- */
nameBtn.onclick=()=>{
  candidate=nameInput.value.trim();
  if(!candidate) return alert("Please enter your name");
  showName.textContent=candidate;
  nameScreen.classList.add("hidden");
  companyScreen.classList.remove("hidden");
  speak(`Welcome ${candidate}. Please choose a company for your interview.`);
};

companyBtns.forEach(btn=>{
  btn.onclick=()=>{
    company=btn.dataset.co;
    questions=BANK[company];
    companyTitle.textContent=`Interview with ${company}`;
    idx=0; score=0;
    companyScreen.classList.add("hidden");
    interviewScreen.classList.remove("hidden");
    askCurrent();
  };
});

function askCurrent(){
  const q=questions[idx];
  questionText.textContent=`Q${idx+1}. ${q}`;
  progress.textContent=`Question ${idx+1} of ${questions.length}`;
  speak(q);
  transcript.value="";
  feedback.classList.add("hidden");
}

/* Recording controls */
recordBtn.onclick=()=>{
  if(recognition&&!recognizing){ try{recognition.start();}catch(e){console.warn(e);} }
};
stopBtn.onclick=()=>{
  if(recognition&&recognizing){ try{recognition.stop();}catch(e){} }
};

/* Evaluate + auto-advance */
evalBtn.onclick=()=>{
  const ans=transcript.value.trim();
  if(!ans) return alert("Answer is empty!");
  let pts=0;
  if(ans.split(" ").length>6) pts=1;
  if(ans.split(" ").length>15) pts=2;
  if(ans.length>100) pts=3;
  score+=pts;

  feedback.textContent=`Scored ${pts}/3 for this question.`;
  feedback.classList.remove("hidden");

  // Auto-advance after 2 sec
  setTimeout(()=>{
    idx++;
    if(idx<questions.length){
      askCurrent();
    } else {
      finishInterview();
    }
  },2000);
};

function finishInterview(){
  interviewScreen.classList.add("hidden");
  resultScreen.classList.remove("hidden");
  finalScore.textContent=`${candidate}, your total score is ${score} / ${questions.length*3}`;
  let msg="Improve depth of answers.";
  if(score>20) msg="Excellent performance, keep it up!";
  else if(score>15) msg="Good, but add more details and examples.";
  improveText.textContent=msg;
  speak(`Interview complete. Your score is ${score}. ${msg}`);
}

/* --- Restart --- */
restartBtn.onclick=()=>{
  // reset variables
  candidate=""; company=""; questions=[]; idx=0; score=0;
  nameInput.value=""; transcript.value="";
  // hide all screens
  nameScreen.classList.remove("hidden");
  companyScreen.classList.add("hidden");
  interviewScreen.classList.add("hidden");
  resultScreen.classList.add("hidden");
  // fresh greeting
  speak("Hello candidate, what is your name?");
};
</script>
</body>
</html>
